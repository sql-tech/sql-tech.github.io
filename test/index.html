<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SQL資料庫百科全書 - 學習SQL、MySQL、Oracle，包含安裝指南和進階指令教學，適合初學者與專業人士！提供SQL指令教學及MySQL、Oracle安裝流程，包含範例，適合初學者與專業開發者。">
    <meta name="keywords" content="SQL, UNION, 子查詢, 窗口函數, MySQL安裝, Oracle安裝, Windows, Linux, MacOS">
    <meta name="author" content="SQL資料庫百科全書團隊">
    <meta property="og:title" content="SQL資料庫百科全書">
    <meta property="og:description" content="SQL資料庫百科全書 - 學習SQL、MySQL、Oracle，包含安裝指南和進階指令教學，適合初學者與專業人士！提供SQL指令教學及MySQL、Oracle安裝流程，包含範例，適合初學者與專業開發者。">
    <meta property="og:url" content="https://sql-tech.github.io//sql-encyclopedia">
    <meta property="og:image" content="https://placehold.co/1200x630/2c3e50/ffffff?text=SQL資料庫百科全書&font=montserrat">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="SQL資料庫百科全書縮圖 - 文字圖片">
    <meta property="og:image:type" content="image/png">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://placehold.co/1200x630/2c3e50/ffffff?text=SQL資料庫百科全書&font=montserrat">
    <title>SQL資料庫百科全書 - 進階 SQL</title>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-50PFF0MS1Q"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-50PFF0MS1Q');
    </script>
    <style>
        body{font-family:Arial,sans-serif;margin:0;padding:0;line-height:1.6;background:#F5F7FA;color:#333}
        .banner{width:100%;height:120px;object-fit:cover}
        .container{display:flex;max-width:1200px;margin:20px auto;flex-wrap:wrap}
        .sidebar{width:25%;padding:20px;background:#2D3748;color:#FFF;box-sizing:border-box}
        .sidebar h2{font-size:1.5em;margin-bottom:10px}
        .sidebar h3{font-size:1.2em;margin:15px 0 5px;color:#A0AEC0}
        .sidebar ul{list-style:none;padding:0}
        .sidebar ul li{margin:8px 0}
        .sidebar ul li a{text-decoration:none;color:#1E90FF;cursor:pointer;font-size:0.95em}
        .sidebar ul li a:hover{text-decoration:underline;color:#63B3ED}
        .content{width:75%;padding:20px;background:#FFF;box-shadow:0 2px 4px rgba(0,0,0,0.1);box-sizing:border-box}
        .content h1{font-size:2em;margin-bottom:20px;color:#2D3748}
        .content h2{font-size:1.5em;margin:15px 0;color:#2D3748}
        .content h3{font-size:1.2em;margin:10px 0;color:#4A5568}
        .content p{font-size:1.1em}
        pre{background:#EDF2F7;padding:10px;border-radius:4px;overflow-x:auto}
        code{color:#2B6CB0;font-family:'Courier New',monospace}
        table{width:100%;border-collapse:collapse;margin:15px 0}
        table,th,td{border:1px solid #E2E8F0}
        th,td{padding:10px;text-align:left}
        th{background:#4A5568;color:#FFF}
        .table-diagram,.mock-screenshot{font-family:monospace;background:#F7FAFC;padding:10px;border:1px solid #E2E8F0;border-radius:4px;margin:10px 0}
        .accordion{margin-bottom:10px}
        .accordion-header{background:#4A5568;color:#FFF;padding:10px;cursor:pointer;font-size:1.2em;border-radius:4px}
        .accordion-header:hover{background:#718096}
        .accordion-content{display:none;padding:15px;border:1px solid #E2E8F0;border-top:none;background:#F7FAFC}
        .accordion-content.active{display:block}
        .sub-accordion{margin:10px 0}
        .sub-accordion-header{background:#718096;color:#FFF;padding:8px;cursor:pointer;font-size:1.1em;border-radius:4px}
        .sub-accordion-header:hover{background:#A0AEC0}
        .sub-accordion-content{display:none;padding:10px;border:1px solid #E2E8F0;border-top:none;background:#EDF2F7}
        .sub-accordion-content.active{display:block}
        .ad-container{margin:20px 0;text-align:center}
        .hamburger{display:none;font-size:24px;cursor:pointer;color:#2D3748;padding:10px}
        .section-title{font-size:1.8em;color:#2D3748;margin:30px 0 15px;border-bottom:2px solid #E2E8F0;padding-bottom:5px}
        footer{font-size:0.9em;color:#777;text-align:center;padding:20px;border-top:1px solid #E2E8F0;margin-top:20px;background:#F5F7FA}
        @media screen and (max-width:768px){
            .banner{height:80px}
            .container{flex-direction:column}
            .sidebar{width:100%;display:none}
            .sidebar.active{display:block}
            .content{width:100%}
            .hamburger{display:block}
            table{display:block;overflow-x:auto}
        }
        @media screen and (min-width:769px) and (max-width:1024px){
            .banner{height:120px}
            .sidebar{width:30%}
            .content{width:70%}
        }
        @media screen and (min-width:1025px){
            .banner{height:150px}
        }
        .banner {
            width: 80%;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px 30px;
            box-sizing: border-box;
            overflow: hidden;
        }
        .banner-image {
            width: 100%;
            height: auto;
            display: block;
            max-height: 180px;
            object-fit: cover;
            border-radius: 8px;
        }
        @media (max-width: 768px) {
            .banner {
                max-width: 90%;
                padding: 15px 20px;
            }
            .banner-image {
                max-height: 140px;
            }
        }
        @media (max-width: 480px) {
            .banner {
                max-width: 95%;
                padding: 10px 15px;
            }
            .banner-image {
                max-height: 100px;
            }
        }
        .share-buttons {
            margin: 15px 0;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .share-button {
            display: inline-block;
            transition: opacity 0.2s;
        }
        .share-button:hover {
            opacity: 0.8;
        }
        .share-button img {
            vertical-align: middle;
        }
        #toggle-lang {
            padding: 10px 20px;
            background: #4A5568;
            color: #FFF;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
        }
        #toggle-lang:hover {
            background: #718096;
        }
    </style>
</head>
<body>
    <header>
        <img src="banner.jpg" alt="SQL資料庫百科全書" class="banner-image">
    </header>
    <div class="container">
        <div class="hamburger">☰</div>
        <div style="text-align: center; margin: 10px 0;">
            <button id="toggle-lang">切換英文</button>
        </div>
        <nav class="sidebar" id="sidebar">
            <h2>SQL指令清單</h2>
            <ul id="nav-list"></ul>
        </nav>
        <main class="content" id="content">
            <!-- 內容將動態填充 -->
        </main>
    </div>
    <footer id="footer">
        <!-- Footer 內容將動態填充 -->
    </footer>
    <script>
        let currentLang = 'chinese';

        // 解析 txt 檔案為鍵值對
        function parseTextFile(text) {
            const sections = text.split('===').map(s => s.trim()).filter(s => s);
            const content = {};
            sections.forEach(section => {
                const lines = section.split('\n').map(line => line.trim()).filter(line => line);
                lines.forEach(line => {
                    if (line.startsWith('#')) return;
                    const [key, ...value] = line.split(': ');
                    if (key && value.length) {
                        content[key] = value.join(': ').replace(/\\n/g, '\n');
                    }
                });
            });
            return content;
        }

        // 載入內容並渲染
        function loadContent(lang) {
            const file = lang === 'chinese' ? 'sql_chinese.txt' : 'sql_english.txt';
            fetch(file)
                .then(response => {
                    if (!response.ok) throw new Error(`無法載入 ${file}，狀態碼: ${response.status}`);
                    return response.text();
                })
                .then(text => {
                    const content = parseTextFile(text);
                    renderSidebar(content);
                    renderMainContent(content);
                    renderFooter(content);
                })
                .catch(error => {
                    console.error('載入錯誤:', error.message);
                    document.getElementById('content').innerHTML = '<p>無法載入內容，請確認檔案是否存在並檢查路徑。</p>';
                });
        }

        // 渲染左側導航
        function renderSidebar(content) {
            const navList = document.getElementById('nav-list');
            navList.innerHTML = '';
            const sections = [
                { key: 'nav_home', id: 'home' },
                { key: 'nav_installation', id: 'installation' },
                { key: 'nav_normalization', id: 'normalization' },
                { key: 'nav_performance', id: 'performance' },
                { key: 'nav_basic_query', isHeader: true },
                { key: 'nav_select', id: 'select' },
                { key: 'nav_distinct', id: 'distinct' },
                { key: 'nav_where', id: 'where' },
                { key: 'nav_and_or', id: 'and_or' },
                { key: 'nav_in', id: 'in' },
                { key: 'nav_between', id: 'between' },
                { key: 'nav_wildcard', id: 'wildcard' },
                { key: 'nav_like', id: 'like' },
                { key: 'nav_order_by', id: 'order_by' },
                { key: 'nav_function', id: 'function' },
                { key: 'nav_avg', id: 'avg' },
                { key: 'nav_count', id: 'count' },
                { key: 'nav_max', id: 'max' },
                { key: 'nav_min', id: 'min' },
                { key: 'nav_sum', id: 'sum' },
                { key: 'nav_group_by', id: 'group_by' },
                { key: 'nav_having', id: 'having' },
                { key: 'nav_alias', id: 'alias' },
                { key: 'nav_as', id: 'as' },
                { key: 'nav_join', id: 'join' },
                { key: 'nav_outer_join', id: 'outer_join' },
                { key: 'nav_concatenate', id: 'concatenate' },
                { key: 'nav_substring', id: 'substring' },
                { key: 'nav_trim', id: 'trim' },
                { key: 'nav_length', id: 'length' },
                { key: 'nav_replace', id: 'replace' },
                { key: 'nav_data_definition', isHeader: true },
                { key: 'nav_create_table', id: 'create_table' },
                { key: 'nav_constraint', id: 'constraint' },
                { key: 'nav_primary_key', id: 'primary_key' },
                { key: 'nav_foreign_key', id: 'foreign_key' },
                { key: 'nav_create_view', id: 'create_view' },
                { key: 'nav_create_index', id: 'create_index' },
                { key: 'nav_alter_table', id: 'alter_table' },
                { key: 'nav_add_column', id: 'add_column' },
                { key: 'nav_modify_column', id: 'modify_column' },
                { key: 'nav_alter_column', id: 'alter_column' },
                { key: 'nav_rename_column', id: 'rename_column' },
                { key: 'nav_drop_column', id: 'drop_column' },
                { key: 'nav_add_index', id: 'add_index' },
                { key: 'nav_drop_index', id: 'drop_index' },
                { key: 'nav_add_constraint', id: 'add_constraint' },
                { key: 'nav_drop_constraint', id: 'drop_constraint' },
                { key: 'nav_drop_table', id: 'drop_table' },
                { key: 'nav_truncate_table', id: 'truncate_table' },
                { key: 'nav_use', id: 'use' },
                { key: 'nav_insert_into', id: 'insert_into' },
                { key: 'nav_update', id: 'update' },
                { key: 'nav_delete_from', id: 'delete_from' },
                { key: 'nav_advanced_sql', isHeader: true },
                { key: 'nav_union', id: 'union' },
                { key: 'nav_union_all', id: 'union_all' },
                { key: 'nav_nested_view', id: 'nested_view' },
                { key: 'nav_intersect', id: 'intersect' },
                { key: 'nav_minus', id: 'minus' },
                { key: 'nav_limit', id: 'limit' },
                { key: 'nav_subquery', id: 'subquery' },
                { key: 'nav_with', id: 'with' },
                { key: 'nav_exists', id: 'exists' },
                { key: 'nav_case', id: 'case' },
                { key: 'nav_window_function', id: 'window_function' },
                { key: 'nav_sequence', id: 'sequence' },
                { key: 'nav_rank', id: 'rank' },
                { key: 'nav_median', id: 'median' },
                { key: 'nav_cumulative_sum', id: 'cumulative_sum' },
                { key: 'nav_sum_percent', id: 'sum_percent' },
                { key: 'nav_cumulative_sum_percent', id: 'cumulative_sum_percent' }
            ];

            sections.forEach(section => {
                if (section.isHeader) {
                    const h3 = document.createElement('h3');
                    h3.textContent = content[section.key] || section.key.replace('nav_', '');
                    navList.appendChild(h3);
                } else {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.textContent = content[section.key] || section.key.replace('nav_', '');
                    a.onclick = () => scrollToSection(section.id);
                    li.appendChild(a);
                    navList.appendChild(li);
                }
            });
        }

        // 渲染主要內容
        function renderMainContent(content) {
            const main = document.getElementById('content');
            main.innerHTML = '';

            // 首頁
            const homeSection = document.createElement('section');
            homeSection.id = 'home';
            homeSection.innerHTML = `
                <h1>${content.home_title || '歡迎來到 SQL資料庫百科全書'}</h1>
                <div class="share-buttons">
                    <a href="https://www.facebook.com/sharer/sharer.php?u=https://sql-tech.github.io/" target="_blank" class="share-button facebook">
                        <img src="https://cdnjs.cloudflare.com/ajax/libs/simple-icons/10.0.0/facebook.svg" alt="Facebook Share" width="32" height="32">
                    </a>
                    <a href="https://x.com/intent/tweet?url=https://sql-tech.github.io/" target="_blank" class="share-button x">
                        <img src="https://cdnjs.cloudflare.com/ajax/libs/simple-icons/10.0.0/x.svg" alt="X Share" width="32" height="32">
                    </a>
                    <a href="https://www.instagram.com/?url=https://sql-tech.github.io/" target="_blank" class="share-button instagram">
                        <img src="https://cdnjs.cloudflare.com/ajax/libs/simple-icons/10.0.0/instagram.svg" alt="Instagram Share" width="32" height="32">
                    </a>
                    <a href="https://line.me/R/msg/text/?探索SQL資料庫百科全書！%0D%0Ahttps://sql-tech.github.io/" target="_blank" class="share-button line">
                        <img src="https://cdnjs.cloudflare.com/ajax/libs/simple-icons/10.0.0/line.svg" alt="Line Share" width="32" height="32">
                    </a>
                </div>
                <p>${content.home_content || ''}</p>
            `;
            main.appendChild(homeSection);

            // 安裝說明書
            const installation = document.createElement('div');
            installation.className = 'accordion';
            installation.id = 'installation';
            installation.innerHTML = `
                <div class="accordion-header" data-id="installation">${content.installation_title || '資料庫安裝說明書'}</div>
                <div class="accordion-content">
                    <h2>簡介</h2>
                    <p>${content.installation_intro || ''}</p>
                    <div class="sub-accordion" id="mysql_windows">
                        <div class="sub-accordion-header" data-id="mysql_windows">${content.mysql_windows_title || 'MySQL 安裝 - Windows'}</div>
                        <div class="sub-accordion-content">
                            <h3>簡介</h3>
                            <p>${content.mysql_windows_intro || ''}</p>
                            <h3>安裝步驟</h3>
                            <p>${content.mysql_windows_steps || ''}</p>
                            <pre><code>${content.mysql_windows_code || ''}</code></pre>
                            <h3>參數</h3>
                            <table><tr><th>參數</th><th>值</th></tr>${content.mysql_windows_params ? content.mysql_windows_params.split('\n').slice(2).map(row => `<tr><td>${row.split('|')[1]}</td><td>${row.split('|')[2]}</td></tr>`).join('') : ''}</table>
                            <h3>注意</h3>
                            <p>${content.mysql_windows_notes || ''}</p>
                            <h3>結構</h3>
                            <pre class="table-diagram">${content.mysql_windows_structure || ''}</pre>
                        </div>
                    </div>
                    <div class="sub-accordion" id="mysql_linux">
                        <div class="sub-accordion-header" data-id="mysql_linux">${content.mysql_linux_title || 'MySQL 安裝 - Linux'}</div>
                        <div class="sub-accordion-content">
                            <h3>簡介</h3>
                            <p>${content.mysql_linux_intro || ''}</p>
                            <h3>安裝步驟</h3>
                            <p>${content.mysql_linux_steps || ''}</p>
                            <pre><code>${content.mysql_linux_code || ''}</code></pre>
                            <h3>參數</h3>
                            <table><tr><th>參數</th><th>值</th></tr>${content.mysql_linux_params ? content.mysql_linux_params.split('\n').slice(2).map(row => `<tr><td>${row.split('|')[1]}</td><td>${row.split('|')[2]}</td></tr>`).join('') : ''}</table>
                            <h3>注意</h3>
                            <p>${content.mysql_linux_notes || ''}</p>
                            <h3>結構</h3>
                            <pre class="table-diagram">${content.mysql_linux_structure || ''}</pre>
                        </div>
                    </div>
                    <div class="sub-accordion" id="mysql_macos">
                        <div class="sub-accordion-header" data-id="mysql_macos">${content.mysql_macos_title || 'MySQL 安裝 - MacOS'}</div>
                        <div class="sub-accordion-content">
                            <h3>簡介</h3>
                            <p>${content.mysql_macos_intro || ''}</p>
                            <h3>安裝步驟</h3>
                            <p>${content.mysql_macos_steps || ''}</p>
                            <pre><code>${content.mysql_macos_code || ''}</code></pre>
                            <h3>參數</h3>
                            <table><tr><th>參數</th><th>值</th></tr>${content.mysql_macos_params ? content.mysql_macos_params.split('\n').slice(2).map(row => `<tr><td>${row.split('|')[1]}</td><td>${row.split('|')[2]}</td></tr>`).join('') : ''}</table>
                            <h3>注意</h3>
                            <p>${content.mysql_macos_notes || ''}</p>
                            <h3>結構</h3>
                            <pre class="table-diagram">${content.mysql_macos_structure || ''}</pre>
                        </div>
                    </div>
                    <div class="sub-accordion" id="oracle_windows">
                        <div class="sub-accordion-header" data-id="oracle_windows">${content.oracle_windows_title || 'Oracle 安裝 - Windows'}</div>
                        <div class="sub-accordion-content">
                            <h3>簡介</h3>
                            <p>${content.oracle_windows_intro || ''}</p>
                            <h3>安裝步驟</h3>
                            <p>${content.oracle_windows_steps || ''}</p>
                            <pre><code>${content.oracle_windows_code || ''}</code></pre>
                            <h3>參數</h3>
                            <table><tr><th>參數</th><th>值</th></tr>${content.oracle_windows_params ? content.oracle_windows_params.split('\n').slice(2).map(row => `<tr><td>${row.split('|')[1]}</td><td>${row.split('|')[2]}</td></tr>`).join('') : ''}</table>
                            <h3>注意</h3>
                            <p>${content.oracle_windows_notes || ''}</p>
                            <h3>結構</h3>
                            <pre class="table-diagram">${content.oracle_windows_structure || ''}</pre>
                        </div>
                    </div>
                    <div class="sub-accordion" id="oracle_linux">
                        <div class="sub-accordion-header" data-id="oracle_linux">${content.oracle_linux_title || 'Oracle 安裝 - Linux'}</div>
                        <div class="sub-accordion-content">
                            <h3>簡介</h3>
                            <p>${content.oracle_linux_intro || ''}</p>
                            <h3>安裝步驟</h3>
                            <p>${content.oracle_linux_steps || ''}</p>
                            <pre><code>${content.oracle_linux_code || ''}</code></pre>
                            <h3>參數</h3>
                            <table><tr><th>參數</th><th>值</th></tr>${content.oracle_linux_params ? content.oracle_linux_params.split('\n').slice(2).map(row => `<tr><td>${row.split('|')[1]}</td><td>${row.split('|')[2]}</td></tr>`).join('') : ''}</table>
                            <h3>注意</h3>
                            <p>${content.oracle_linux_notes || ''}</p>
                            <h3>結構</h3>
                            <pre class="table-diagram">${content.oracle_linux_structure || ''}</pre>
                        </div>
                    </div>
                    <div class="sub-accordion" id="oracle_macos">
                        <div class="sub-accordion-header" data-id="oracle_macos">${content.oracle_macos_title || 'Oracle 安裝 - MacOS'}</div>
                        <div class="sub-accordion-content">
                            <h3>簡介</h3>
                            <p>${content.oracle_macos_intro || ''}</p>
                            <h3>安裝步驟</h3>
                            <p>${content.oracle_macos_steps || ''}</p>
                            <pre><code>${content.oracle_macos_code || ''}</code></pre>
                            <h3>參數</h3>
                            <table><tr><th>參數</th><th>值</th></tr>${content.oracle_macos_params ? content.oracle_macos_params.split('\n').slice(2).map(row => `<tr><td>${row.split('|')[1]}</td><td>${row.split('|')[2]}</td></tr>`).join('') : ''}</table>
                            <h3>注意</h3>
                            <p>${content.oracle_macos_notes || ''}</p>
                            <h3>結構</h3>
                            <pre class="table-diagram">${content.oracle_macos_structure || ''}</pre>
                        </div>
                    </div>
                </div>
            `;
            main.appendChild(installation);

            // 正規化說明書
            const normalization = document.createElement('div');
            normalization.className = 'accordion';
            normalization.id = 'normalization';
            normalization.innerHTML = `
                <div class="accordion-header" data-id="normalization">${content.normalization_title || '資料庫正規化說明書'}</div>
                <div class="accordion-content">
                    <h2>簡介</h2>
                    <p>${content.normalization_intro || ''}</p>
                    <div class="sub-accordion" id="first_normal_form">
                        <div class="sub-accordion-header" data-id="first_normal_form">${content.first_normal_form_title || '第一階正規化（1NF）'}</div>
                        <div class="sub-accordion-content">
                            <h3>定義</h3>
                            <p>${content.first_normal_form_definition || ''}</p>
                            <h3>規則</h3>
                            <p>${content.first_normal_form_rules || ''}</p>
                            <h3>範例</h3>
                            <p>${content.first_normal_form_example || ''}</p>
                            <h3>圖示</h3>
                            <pre class="table-diagram">${content.first_normal_form_diagram || ''}</pre>
                            <h3>注意</h3>
                            <p>${content.first_normal_form_notes || ''}</p>
                        </div>
                    </div>
                    <div class="sub-accordion" id="second_normal_form">
                        <div class="sub-accordion-header" data-id="second_normal_form">${content.second_normal_form_title || '第二階正規化（2NF）'}</div>
                        <div class="sub-accordion-content">
                            <h3>定義</h3>
                            <p>${content.second_normal_form_definition || ''}</p>
                            <h3>規則</h3>
                            <p>${content.second_normal_form_rules || ''}</p>
                            <h3>範例</h3>
                            <p>${content.second_normal_form_example || ''}</p>
                            <h3>圖示</h3>
                            <pre class="table-diagram">${content.second_normal_form_diagram || ''}</pre>
                            <h3>注意</h3>
                            <p>${content.second_normal_form_notes || ''}</p>
                        </div>
                    </div>
                    <div class="sub-accordion" id="third_normal_form">
                        <div class="sub-accordion-header" data-id="third_normal_form">${content.third_normal_form_title || '第三階正規化（3NF）'}</div>
                        <div class="sub-accordion-content">
                            <h3>定義</h3>
                            <p>${content.third_normal_form_definition || ''}</p>
                            <h3>規則</h3>
                            <p>${content.third_normal_form_rules || ''}</p>
                            <h3>範例</h3>
                            <p>${content.third_normal_form_example || ''}</p>
                            <h3>圖示</h3>
                            <pre class="table-diagram">${content.third_normal_form_diagram || ''}</pre>
                            <h3>注意</h3>
                            <p>${content.third_normal_form_notes || ''}</p>
                        </div>
                    </div>
                    <div class="sub-accordion" id="fourth_normal_form">
                        <div class="sub-accordion-header" data-id="fourth_normal_form">${content.fourth_normal_form_title || '第四階正規化（4NF）'}</div>
                        <div class="sub-accordion-content">
                            <h3>定義</h3>
                            <p>${content.fourth_normal_form_definition || ''}</p>
                            <h3>規則</h3>
                            <p>${content.fourth_normal_form_rules || ''}</p>
                            <h3>範例</h3>
                            <p>${content.fourth_normal_form_example || ''}</p>
                            <h3>圖示</h3>
                            <pre class="table-diagram">${content.fourth_normal_form_diagram || ''}</pre>
                            <h3>注意</h3>
                            <p>${content.fourth_normal_form_notes || ''}</p>
                        </div>
                    </div>
                    <div class="sub-accordion" id="fifth_normal_form">
                        <div class="sub-accordion-header" data-id="fifth_normal_form">${content.fifth_normal_form_title || '第五階正規化（5NF）'}</div>
                        <div class="sub-accordion-content">
                            <h3>定義</h3>
                            <p>${content.fifth_normal_form_definition || ''}</p>
                            <h3>規則</h3>
                            <p>${content.fifth_normal_form_rules || ''}</p>
                            <h3>範例</h3>
                            <p>${content.fifth_normal_form_example || ''}</p>
                            <h3>圖示</h3>
                            <pre class="table-diagram">${content.fifth_normal_form_diagram || ''}</pre>
                            <h3>注意</h3>
                            <p>${content.fifth_normal_form_notes || ''}</p>
                        </div>
                    </div>
                </div>
            `;
            main.appendChild(normalization);

            // 效能提升
            const performance = document.createElement('div');
            performance.className = 'accordion';
            performance.id = 'performance';
            performance.innerHTML = `
                <div class="accordion-header" data-id="performance">${content.performance_title || '資料庫效能提升標準作業流程'}</div>
                <div class="accordion-content">
                    <h2>簡介</h2>
                    <p>${content.performance_intro || ''}</p>
                    <div class="sub-accordion" id="mysql_config">
                        <div class="sub-accordion-header" data-id="mysql_config">${content.mysql_config_title || 'MySQL 配置優化'}</div>
                        <div class="sub-accordion-content">
                            <h3>簡介</h3>
                            <p>${content.mysql_config_intro || ''}</p>
                            <h3>步驟</h3>
                            <p>${content.mysql_config_steps || ''}</p>
                            <pre><code>${content.mysql_config_code || ''}</code></pre>
                            <h3>參數</h3>
                            <table><tr><th>參數</th><th>值</th></tr>${content.mysql_config_params ? content.mysql_config_params.split('\n').slice(2).map(row => `<tr><td>${row.split('|')[1]}</td><td>${row.split('|')[2]}</td></tr>`).join('') : ''}</table>
                            <h3>注意</h3>
                            <p>${content.mysql_config_notes || ''}</p>
                            <h3>結構</h3>
                            <pre class="table-diagram">${content.mysql_config_structure || ''}</pre>
                        </div>
                    </div>
                </div>
            `;
            main.appendChild(performance);

            // SQL 指令
            const sqlSections = [
                'select', 'distinct', 'where', 'and_or', 'in', 'between', 'wildcard', 'like', 'order_by', 'function',
                'avg', 'count', 'max', 'min', 'sum', 'group_by', 'having', 'alias', 'as', 'join', 'outer_join',
                'concatenate', 'substring', 'trim', 'length', 'replace', 'create_table', 'constraint', 'primary_key',
                'foreign_key', 'create_view', 'create_index', 'alter_table', 'add_column', 'modify_column', 'alter_column',
                'rename_column', 'drop_column', 'add_index', 'drop_index', 'add_constraint', 'drop_constraint', 'drop_table',
                'truncate_table', 'use', 'insert_into', 'update', 'delete_from', 'union', 'union_all', 'nested_view',
                'intersect', 'minus', 'limit', 'subquery', 'with', 'exists', 'case', 'window_function', 'sequence',
                'rank', 'median', 'cumulative_sum', 'sum_percent', 'cumulative_sum_percent'
            ];

            sqlSections.forEach(section => {
                const div = document.createElement('div');
                div.className = 'accordion';
                div.id = section;
                div.innerHTML = `
                    <div class="accordion-header" data-id="${section}">${content[`${section}_title`] || section.toUpperCase()}</div>
                    <div class="accordion-content">
                        <h2>語法</h2>
                        <pre><code>${content[`${section}_syntax`] || ''}</code></pre>
                        <h3>範例</h3>
                        <h4>一般</h4>
                        <p>${content[`${section}_example_general`] || ''}</p>
                        <table><tr><th>${content[`${section}_example_general_table`] ? content[`${section}_example_general_table`].split('\n')[0] : '結果'}</th></tr><tr><td>${content[`${section}_example_general_table`] ? content[`${section}_example_general_table`].split('\n').slice(2).join('<br>') : ''}</td></tr></table>
                        <h4>MySQL</h4>
                        <p>${content[`${section}_example_mysql`] || ''}</p>
                        <table><tr><th>${content[`${section}_example_mysql_table`] ? content[`${section}_example_mysql_table`].split('\n')[0] : '結果'}</th></tr><tr><td>${content[`${section}_example_mysql_table`] ? content[`${section}_example_mysql_table`].split('\n').slice(2).join('<br>') : ''}</td></tr></table>
                        <h4>Oracle</h4>
                        <p>${content[`${section}_example_oracle`] || ''}</p>
                        <table><tr><th>${content[`${section}_example_oracle_table`] ? content[`${section}_example_oracle_table`].split('\n')[0] : '結果'}</th></tr><tr><td>${content[`${section}_example_oracle_table`] ? content[`${section}_example_oracle_table`].split('\n').slice(2).join('<br>') : ''}</td></tr></table>
                        <h3>結構</h3>
                        <pre class="table-diagram">${content[`${section}_structure`] || ''}</pre>
                    </div>
                `;
                main.appendChild(div);
            });
        }

        // 渲染頁腳
        function renderFooter(content) {
            const footer = document.getElementById('footer');
            footer.innerHTML = `<p>${content.footer_content || '最後編輯時間：2025年4月9日 | 聯絡信箱：123goyellowbook@gmail.com | © 2025 SQL資料庫百科全書。保留所有權利。'}</p>`;
        }

        // 切換語言
        function toggleLanguage() {
            currentLang = currentLang === 'chinese' ? 'english' : 'chinese';
            document.getElementById('toggle-lang').textContent = currentLang === 'chinese' ? '切換英文' : '切換中文';
            loadContent(currentLang);
        }

        // 初始化載入
        document.addEventListener('DOMContentLoaded', () => {
            loadContent('chinese');

            // Accordion 邏輯
            const toggleAccordion = id => {
                try {
                    const content = document.querySelector(`#${id} .accordion-content`);
                    if (!content) throw new Error(`No content for ID: ${id}`);
                    document.querySelectorAll('.accordion-content').forEach(c => {
                        if (c !== content) c.classList.remove('active');
                    });
                    content.classList.toggle('active');
                    document.querySelector(`#${id}`).scrollIntoView({ behavior: 'smooth' });
                } catch (e) {
                    console.error('Accordion Error:', e.message);
                }
            };
            const toggleSubAccordion = id => {
                try {
                    const content = document.querySelector(`#${id} .sub-accordion-content`);
                    if (!content) throw new Error(`No sub-content for ID: ${id}`);
                    document.querySelectorAll('.sub-accordion-content').forEach(c => {
                        if (c !== content) c.classList.remove('active');
                    });
                    content.classList.toggle('active');
                    document.querySelector(`#${id}`).scrollIntoView({ behavior: 'smooth' });
                } catch (e) {
                    console.error('Sub-Accordion Error:', e.message);
                }
            };
            const scrollToSection = id => {
                document.querySelector(`#${id}`).scrollIntoView({ behavior: 'smooth' });
                if (window.innerWidth <= 768) {
                    document.querySelector('.sidebar').classList.remove('active');
                }
            };

            // 動態綁定事件
            document.addEventListener('click', (e) => {
                const header = e.target.closest('.accordion-header');
                const subHeader = e.target.closest('.sub-accordion-header');
                if (header) {
                    toggleAccordion(header.getAttribute('data-id'));
                } else if (subHeader) {
                    toggleSubAccordion(subHeader.getAttribute('data-id'));
                }
            });

            document.querySelector('.hamburger').addEventListener('click', () => {
                document.querySelector('.sidebar').classList.toggle('active');
            });

            window.toggleAccordion = toggleAccordion;
            window.toggleSubAccordion = toggleSubAccordion;
            window.scrollToSection = scrollToSection;
        });
    </script>
</body>
</html>